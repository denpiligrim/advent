<?php

namespace Database\Seeders;

use App\Models\Task;
use Illuminate\Database\Seeder;
use Illuminate\Support\Facades\DB;

class AdventTaskSeeder extends Seeder
{
    public function run()
    {
        DB::statement('SET FOREIGN_KEY_CHECKS=0;');
        DB::table('user_tasks')->truncate();
        Task::truncate();
        DB::statement('SET FOREIGN_KEY_CHECKS=1;');

        $data = [
            // ДЕНЬ 1: Традиции
            ['date' => '2026-01-01', 'q1' => ['Кто раздает подарки в США?', 'Санта-Клаус|Пасхальный заяц', 'Санта-Клаус'], 'q2' => ['В какой стране на Новый год едят 12 виноградин?', 'Испания|Италия|Франция|Греция', 'Испания'], 'q3' => ['Зимний марафон начинается! Как называется традиционный русский новогодний напиток из меда?', 'сбитень,медовуха']],
            
            // ДЕНЬ 2: Фильмы
            ['date' => '2026-01-02', 'q1' => ['Забыли ли Кевина дома в первой части "Один дома"?', 'Да|Нет', 'Да'], 'q2' => ['Как звали эльфа, который хотел стать стоматологом?', 'Герми|Бадди|Добби|Бернард', 'Герми'], 'q3' => ['В каком городе происходит действие фильма "Ирония судьбы"?', 'ленинград,петербург,спб,санкт-петербург']],

            // ДЕНЬ 3: Символы
            ['date' => '2026-01-03', 'q1' => ['Символ 2026 года — Огненная Лошадь?', 'Да|Нет', 'Да'], 'q2' => ['Какого цвета одежда у оригинального Николая Чудотворца?', 'Зеленая|Красная|Синяя|Белая', 'Зеленая'], 'q3' => ['Как зовут спутника Санты в Германии, который наказывает непослушных детей?', 'крампус,крампус']],

            // ДЕНЬ 4: Кухня
            ['date' => '2026-01-04', 'q1' => ['Оливье изначально был салатом?', 'Да|Нет', 'Да'], 'q2' => ['Какое блюдо называют "Сельдь под шубой"?', 'Рыба с овощами|Мясной рулет|Суп|Десерт', 'Рыба с овощами'], 'q3' => ['Как называется имбирное печенье в форме человечка?', 'пряник,человечек,имбирчик']],

            // ДЕНЬ 5: География
            ['date' => '2026-01-05', 'q1' => ['В Австралии Новый год празднуют летом?', 'Да|Нет', 'Да'], 'q2' => ['Где живет Дед Мороз в России?', 'Великий Устюг|Москва|Сибирь|Мурманск', 'Великий Устюг'], 'q3' => ['В какой стране Деда Мороза называют Йоулупукки?', 'финляндия,финны']],

            // ДЕНЬ 6: Музыка
            ['date' => '2026-01-06', 'q1' => ['Песня "Jingle Bells" изначально была написана для Дня благодарения?', 'Да|Нет', 'Да'], 'q2' => ['Кто исполнитель хита "Last Christmas"?', 'Wham!|ABBA|Queen|Madonna', 'Wham!'], 'q3' => ['Какое дерево "родилось в лесу" в знаменитой песне?', 'елочка,ель,елка']],

            // ДЕНЬ 7: Рождество
            ['date' => '2026-01-07', 'q1' => ['Рождество в России празднуют 7 января?', 'Да|Нет', 'Да'], 'q2' => ['Что символизирует Рождественская звезда?', 'Путь волхвов|Начало зимы|Снег|Подарки', 'Путь волхвов'], 'q3' => ['Как называются рождественские песни-поздравления?', 'колядки,колядка,щедривки']],

            // ДЕНЬ 8: История
            ['date' => '2026-01-08', 'q1' => ['Петр I перенес празднование Нового года на 1 января?', 'Да|Нет', 'Да'], 'q2' => ['В каком году была выпущена первая новогодняя открытка?', '1843|1901|1812|1950', '1843'], 'q3' => ['Как раньше называли Деда Мороза на Руси (дух зимы)?', 'трескун,морозко,студенец']],

            // ДЕНЬ 9: Мультфильмы
            ['date' => '2026-01-09', 'q1' => ['Гринч украл Рождество?', 'Да|Нет', 'Да'], 'q2' => ['Как звали снеговика из "Холодного сердца"?', 'Олаф|Свен|Кристофф|Ханс', 'Олаф'], 'q3' => ['Кто почтальон в мультфильме "Зима в Простоквашино"?', 'печкин,игорь иванович']],

            // ДЕНЬ 10: Рекорды
            ['date' => '2026-01-10', 'q1' => ['Самая большая снежинка в мире была больше 30 см?', 'Да|Нет', 'Да'], 'q2' => ['Какая страна поставляет елку для Трафальгарской площади в Лондоне?', 'Норвегия|Швеция|Канада|Дания', 'Норвегия'], 'q3' => ['Из чего делают классические китайские новогодние фонарики?', 'бумага,шелк,ткань']],

            // ДЕНЬ 11: Финал
            ['date' => '2026-01-11', 'q1' => ['Ты готов получить финальный приз?', 'Да|Конечно', 'Да'], 'q2' => ['Сколько дней длился наш адвент?', '11|10|12|7', '11'], 'q3' => ['Напиши главное слово этого праздника?', 'счастье,любовь,радость,семья']],
        ];

        foreach ($data as $dayData) {
            // 1. Задание (2 варианта)
            Task::create([
                'active_date' => $dayData['date'],
                'sort_order' => 1,
                'type' => 'button',
                'question' => $dayData['q1'][0],
                'options' => $dayData['q1'][1], // Сохраняем варианты через |
                'correct_answer' => $dayData['q1'][2],
                'points' => 5,
            ]);

            // 2. Задание (4 варианта)
            Task::create([
                'active_date' => $dayData['date'],
                'sort_order' => 2,
                'type' => 'button',
                'question' => $dayData['q2'][0],
                'options' => $dayData['q2'][1],
                'correct_answer' => $dayData['q2'][2],
                'points' => 10,
            ]);

            // 3. Задание (Текст)
            Task::create([
                'active_date' => $dayData['date'],
                'sort_order' => 3,
                'type' => 'text',
                'question' => $dayData['q3'][0],
                'correct_answer' => $dayData['q3'][1], // Массив слов через запятую
                'points' => 15,
            ]);
        }
    }
}